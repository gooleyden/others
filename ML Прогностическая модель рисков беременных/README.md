# **Прогностическая модель рисков беременных**

**Задача:**
- Создать модель МО, которая выявляет риски у беременных.

**Описание данных:**
- Датасет с медицинскими данными о пациенте:
    - возраст, систолическое и диастолическое АД, уровень глюкозы в крови, температура тела в фаренгейтах, частота сердечных сокращений, уровень риска (целевая переменная).

**План работы:**
1. Загрузка и первичное ознакомление с данными;
2. Предобработка данных;
3. Анализ данных;
4. Корреляционный анализ;
5. Подготовка данных к обучению;
6. Обучение моделей: SVC, KNeighbors, DecisionTree, LightGBM (с и без весов классов и подбором порога классификации);
7. Выбор лучшей модели;
8. Проверка на test;
9. Вывод.

_____

# Результат:

Выбрана метрика f1 macro, точность определения 2 класса (высокий риск) определена как наиболее значимая.

Результат лучшей модели LGBMClassifier с порогом классификации 0.1 для класса 2 (high risk):

На кросс-валидации:
- f1_macro = 0.839

На test:
- f1_macro = 0.836
- Accuracy = 0.83
- 0 класс: Recall = 0.75, Precision = 0.85
- 1 класс: Recall = 0.8, Precision = 0.75
- 2 класс: Recall = 0.98, Precision = 0.9

Матрица ошибок на тесте:

<img width="623" height="455" alt="image" src="https://github.com/user-attachments/assets/a7becac3-92be-426a-95ef-4f44d0f3bc64" />

* *0 - низкий риск, 1 - средний риск, 2 - высокий риск*

# Интерпретация результата

Метрика f1 на тесте получилась довольно высокой (0.836) и стабильной - всего на 0.03 ниже, чем при кросс-валидации: это означает, что модель устойчива к изменению тестовой выборки.

С классом 2 (высокий риск) модель с установленным порогом классификации справляется хорошо:
- Найдены 53 из 54 пациентов с высоким риском, при этом единственный неверно классифицированный отнесен к классу 0 (низкий риск)
- 6 пациентов с низким  и средним риском ошибочно классифицированы как пациенты с высоким риском
- Recall = 0.98, Precision = 0.9

Класс 1 (средний риск):
- Найдены 52 из 65 таких пациентов. 9 отнесены моделью к 0 классу, еще 4 - ко 2.
- Recall = 0.8, Precision = 0.75

Самый низкий recall у класса 0:
- Верно классифицированы только 56 из 75 таких пациентов. 17 отнесены к 1 классу, 2 - ко 2, высокого риска.
- Recall = 0.75, Precision = 0.85

____

**Итого:**
- Модель позволяет выявлять 98% пациентов с высоким риском, при этом всего 10% из классифицированных моделью как пациенты с высоким риском на самом деле будут иметь низкий/средний риск. 
